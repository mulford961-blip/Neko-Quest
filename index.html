<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Habit Tracker â€” Obsidian Edition</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { inter: ['Inter', 'ui-sans-serif', 'system-ui'] }
        }
      }
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://unpkg.com/lucide@0.468.0/dist/umd/lucide.min.js"></script>

  <style>
    :root{
      --bg:#0b0b0d;
      --card:rgba(18, 18, 18, 0.7);
      --border:rgba(255, 255, 255, 0.08);
      --accent:#00f5ff;
      --muted:#8b8b93;
    }

    *{
      -webkit-font-smoothing: antialiased;
    }

    body{
      scroll-snap-type: y mandatory;
      background: radial-gradient(circle at top, rgba(0,245,255,0.08), transparent 40%), var(--bg);
    }

    .snap-section{
      scroll-snap-align: start;
      scroll-margin-top: 24px;
    }

    .glass-card{
      background: var(--card);
      border: 1px solid var(--border);
      backdrop-filter: blur(25px);
      -webkit-backdrop-filter: blur(25px);
    }

    .tile{
      transition: transform 0.25s ease, box-shadow 0.3s ease, opacity 0.3s ease;
    }

    .tile:hover{
      transform: scale(1.03);
    }

    .tile:active{
      transform: scale(0.98);
    }

    .tile.is-complete{
      box-shadow: 0 0 30px rgba(0,245,255,0.28), 0 0 0 1px rgba(0,245,255,0.3);
    }

    .tile.is-complete .tile-title,
    .tile.is-complete .tile-meta{
      color: rgba(226,232,240,0.6);
    }

    .tile.is-complete .tile-status{
      color: rgba(0,245,255,0.75);
    }

    .reveal{
      opacity: 0;
      transform: translateY(24px);
    }

    .reveal.is-visible{
      opacity: 1;
      transform: translateY(0);
    }

    .bento-grid{
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      grid-auto-rows: 160px;
      gap: 18px;
      grid-auto-flow: dense;
    }

    .tile--wide{
      grid-column: span 2;
    }

    .progress-ring{
      stroke: rgba(0,245,255,0.9);
      filter: drop-shadow(0 0 12px rgba(0,245,255,0.35));
      transition: stroke-dashoffset 0.6s cubic-bezier(.2,.8,.2,1);
    }

    .progress-track{
      stroke: rgba(148,163,184,0.15);
    }
  </style>
</head>

<body class="font-inter text-slate-100 selection:bg-[var(--accent)]/30">
  <main class="max-w-6xl mx-auto px-4 py-10 space-y-10">
    <section class="snap-section glass-card rounded-3xl p-6 sm:p-8">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div>
          <p class="text-xs uppercase tracking-[0.3em] text-[var(--muted)]">Habit Tracker</p>
          <h1 class="mt-2 text-2xl sm:text-3xl font-semibold tracking-tight">Obsidian Momentum Console</h1>
          <p class="mt-2 text-sm text-slate-400">Minimal interface. Maximum follow-through.</p>
        </div>
        <div class="glass-card rounded-2xl px-4 py-3 flex items-center gap-4">
          <div class="text-right">
            <p class="text-xs uppercase tracking-[0.3em] text-[var(--muted)]">Progress Gauge</p>
            <p class="text-lg font-semibold" id="progressLabel">0% Complete</p>
          </div>
          <div class="relative w-20 h-20">
            <svg width="80" height="80" viewBox="0 0 120 120">
              <circle class="progress-track" cx="60" cy="60" r="46" stroke-width="10" fill="none"></circle>
              <circle class="progress-ring" cx="60" cy="60" r="46" stroke-width="10" fill="none"
                      stroke-linecap="round" transform="rotate(-90 60 60)" id="progressRing"></circle>
            </svg>
            <div class="absolute inset-0 flex items-center justify-center text-lg font-semibold" id="progressPct">0%</div>
          </div>
        </div>
      </div>
    </section>

    <section class="snap-section">
      <div class="flex items-center justify-between mb-4">
        <div>
          <p class="text-xs uppercase tracking-[0.35em] text-[var(--muted)]">Daily Habits</p>
          <h2 class="text-xl font-semibold tracking-tight">Bento Habit Grid</h2>
        </div>
        <button id="completeAllBtn" class="glass-card rounded-xl px-4 py-2 text-xs uppercase tracking-[0.3em] text-slate-200 hover:text-white transition">Complete All</button>
      </div>
      <div id="habitGrid" class="bento-grid"></div>
    </section>

    <section class="snap-section glass-card rounded-3xl p-6 sm:p-8">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div>
          <p class="text-xs uppercase tracking-[0.35em] text-[var(--muted)]">Momentum</p>
          <h2 class="text-xl font-semibold tracking-tight">Consistency Graph</h2>
          <p class="mt-1 text-sm text-slate-400">Weekly signal of habit adherence.</p>
        </div>
        <div class="glass-card rounded-2xl px-4 py-3 flex items-center gap-2">
          <span class="h-2 w-2 rounded-full bg-[var(--accent)]"></span>
          <span class="text-xs uppercase tracking-[0.3em] text-slate-300">Pulse</span>
        </div>
      </div>

      <div class="mt-4 glass-card rounded-2xl p-4">
        <canvas id="momentumChart" height="120"></canvas>
      </div>
    </section>
  </main>

  <script>
    const clamp = (n, min, max) => Math.max(min, Math.min(max, n));
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const $  = (sel, root=document) => root.querySelector(sel);

    const STORAGE_KEY = "habit_obsidian_v1";

    const defaultState = {
      habits: [
        { id: "ritual", title: "Morning Ritual", detail: "Breathwork + journal", time: "06:30", icon: "sunrise", size: "wide", done: false },
        { id: "deep", title: "Deep Focus", detail: "2 x 50 min sprints", time: "09:00", icon: "brain", size: "wide", done: false },
        { id: "lift", title: "Strength", detail: "PPL cycle", time: "12:30", icon: "dumbbell", size: "single", done: false },
        { id: "walk", title: "Recovery Walk", detail: "20 min outdoors", time: "15:00", icon: "footprints", size: "single", done: false },
        { id: "hydrate", title: "Hydration", detail: "3L target", time: "All day", icon: "droplets", size: "single", done: false },
        { id: "read", title: "Skill Reading", detail: "30 min", time: "20:00", icon: "book-open", size: "single", done: false },
        { id: "shutdown", title: "Night Shutdown", detail: "Plan tomorrow", time: "22:00", icon: "moon", size: "wide", done: false }
      ]
    };

    function loadState(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return structuredClone(defaultState);
      return { ...structuredClone(defaultState), ...JSON.parse(raw) };
    }

    function saveState(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    let state = loadState();

    const RING_RADIUS = 46;
    const CIRC = 2 * Math.PI * RING_RADIUS;

    function renderProgress(){
      const total = state.habits.length;
      const done = state.habits.filter(h => h.done).length;
      const pct = total ? Math.round((done / total) * 100) : 0;

      const ring = $("#progressRing");
      ring.style.strokeDasharray = `${CIRC} ${CIRC}`;
      ring.style.strokeDashoffset = `${CIRC - (pct/100) * CIRC}`;

      $("#progressPct").textContent = `${pct}%`;
      $("#progressLabel").textContent = `${pct}% Complete`;
    }

    function habitTileTemplate(habit, index){
      const sizeClass = habit.size === "wide" ? "tile--wide" : "";
      const statusText = habit.done ? "Complete" : "Pending";

      return `
        <button class="tile reveal glass-card rounded-3xl p-5 flex flex-col justify-between ${sizeClass} ${habit.done ? "is-complete" : ""}"
                data-id="${habit.id}" data-index="${index}">
          <div class="flex items-start justify-between gap-2">
            <div>
              <p class="text-xs uppercase tracking-[0.3em] text-[var(--muted)]">${habit.time}</p>
              <h3 class="tile-title mt-2 text-lg font-semibold">${habit.title}</h3>
              <p class="tile-meta mt-1 text-sm text-slate-400">${habit.detail}</p>
            </div>
            <div class="h-10 w-10 rounded-2xl border border-white/10 bg-black/30 flex items-center justify-center">
              <i data-lucide="${habit.icon}" class="h-5 w-5 ${habit.done ? "text-[var(--accent)]" : "text-slate-300"}"></i>
            </div>
          </div>
          <div class="flex items-center justify-between">
            <span class="tile-status text-xs uppercase tracking-[0.3em] ${habit.done ? "text-[var(--accent)]" : "text-slate-400"}">${statusText}</span>
            <span class="text-xs text-slate-500">Tap to toggle</span>
          </div>
        </button>
      `;
    }

    function renderHabits(){
      const grid = $("#habitGrid");
      grid.innerHTML = state.habits.map(habitTileTemplate).join("");
      lucide.createIcons();
      setupReveal();
    }

    function toggleHabit(id){
      const habit = state.habits.find(h => h.id === id);
      if(!habit) return;
      habit.done = !habit.done;
      saveState();
      renderHabits();
      renderProgress();
    }

    $("#habitGrid").addEventListener("click", (e) => {
      const tile = e.target.closest(".tile");
      if(!tile) return;
      toggleHabit(tile.dataset.id);
    });

    $("#completeAllBtn").addEventListener("click", () => {
      state.habits = state.habits.map(h => ({ ...h, done: true }));
      saveState();
      renderHabits();
      renderProgress();
    });

    function setupReveal(){
      const tiles = $$(".reveal");
      tiles.forEach((tile, index) => {
        tile.style.transitionDelay = `${index * 50}ms`;
      });

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if(entry.isIntersecting){
            entry.target.classList.add("is-visible");
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.2 });

      tiles.forEach(tile => observer.observe(tile));
    }

    let chart;
    function renderChart(){
      const ctx = $("#momentumChart");
      const labels = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];
      const data = [64, 70, 66, 78, 82, 80, 88];

      if(chart) chart.destroy();

      chart = new Chart(ctx, {
        type: "line",
        data: {
          labels,
          datasets: [{
            label: "Consistency",
            data,
            borderColor: "rgba(0,245,255,0.9)",
            backgroundColor: "rgba(0,245,255,0.12)",
            fill: true,
            tension: 0.35,
            borderWidth: 2,
            pointRadius: 3,
            pointHoverRadius: 5,
            pointBackgroundColor: "rgba(0,245,255,0.9)"
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              backgroundColor: "rgba(12,12,14,0.95)",
              borderColor: "rgba(255,255,255,0.08)",
              borderWidth: 1,
              titleColor: "rgba(226,232,240,1)",
              bodyColor: "rgba(226,232,240,0.9)",
              displayColors: false
            }
          },
          scales: {
            x: {
              grid: { color: "rgba(255,255,255,0.05)" },
              ticks: { color: "rgba(148,163,184,0.85)" }
            },
            y: {
              suggestedMin: 40,
              suggestedMax: 100,
              grid: { color: "rgba(255,255,255,0.05)" },
              ticks: { color: "rgba(148,163,184,0.85)" }
            }
          }
        }
      });
    }

    function renderAll(){
      renderProgress();
      renderHabits();
      renderChart();
    }

    renderAll();
  </script>
</body>
</html>
